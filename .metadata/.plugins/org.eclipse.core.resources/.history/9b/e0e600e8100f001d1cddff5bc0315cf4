package com.mybatis.config;

import javax.sql.DataSource;

import org.apache.ibatis.datasource.pooled.PooledDataSource;
import org.apache.ibatis.mapping.Environment;
import org.apache.ibatis.session.Configuration;
import org.apache.ibatis.session.SqlSessionFactory;
import org.apache.ibatis.session.SqlSessionFactoryBuilder;
import org.apache.ibatis.transaction.jdbc.JdbcTransactionFactory;
import org.mybatis.spring.annotation.MapperScan;
import org.springframework.context.annotation.Bean;

@org.springframework.context.annotation.Configuration
@MapperScan("com.baeldung.mybatis")
public class PersistenceConfig {

	@Bean
	public SqlSessionFactory sqlSessionFactory() throws Exception {
		DataSource dataSource = new PooledDataSource("com.mysql.cj.jdbc.Driver", "jdbc:mysql://localhost:3306/test",
				"root", "1998");

		Environment environment = new Environment("Development", new JdbcTransactionFactory(), dataSource);

		Configuration configuration = new Configuration(environment);
		//configuration.addMapper(PersonMapper.class);

		SqlSessionFactoryBuilder builder = new SqlSessionFactoryBuilder();
		SqlSessionFactory sqlSessionFactory = builder.build(configuration);
        return sqlSessionFactory;
	}
}